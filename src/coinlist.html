<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coin List</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4-4.1.1/jq-3.3.1/dt-1.10.24/sl-1.3.3/datatables.min.css"/>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs4-4.1.1/jq-3.3.1/dt-1.10.24/sl-1.3.3/datatables.min.js"></script>
</head>
<body>
    <div class="container">
        <nav class="navbar navbar-light bg-light">
            <div class="container-fluid">
                <span class="navbar-brand mb-0 h1">Crypee - a API for get last hour price of crypto currencies</span>
            </div>
        </nav>
        <h5 class="mt-3 mb-3 text-center">Coin List</h5>

        <div class="form-row mb-4">
            <label for="currency">Currency</label>
            <select id="currency" class="custom-select">
                <option value="btc">btc</option>
                <option value="eth">eth</option>
                <option value="ltc">ltc</option>
                <option value="bch">bch</option>
                <option value="bnb">bnb</option>
                <option value="eos">eos</option>
                <option value="xrp">xrp</option>
                <option value="xlm">xlm</option>
                <option value="link">link</option>
                <option value="dot">dot</option>
                <option value="yfi">yfi</option>
                <option value="usd" selected>usd</option>
                <option value="aed">aed</option>
                <option value="ars">ars</option>
                <option value="aud">aud</option>
                <option value="bdt">bdt</option>
                <option value="bhd">bhd</option>
                <option value="bmd">bmd</option>
                <option value="brl">brl</option>
                <option value="cad">cad</option>
                <option value="chf">chf</option>
                <option value="clp">clp</option>
                <option value="cny">cny</option>
                <option value="czk">czk</option>
                <option value="dkk">dkk</option>
                <option value="eur">eur</option>
                <option value="gbp">gbp</option>
                <option value="hkd">hkd</option>
                <option value="huf">huf</option>
                <option value="idr">idr</option>
                <option value="ils">ils</option>
                <option value="inr">inr</option>
                <option value="jpy">jpy</option>
                <option value="krw">krw</option>
                <option value="kwd">kwd</option>
                <option value="lkr">lkr</option>
                <option value="mmk">mmk</option>
                <option value="mxn">mxn</option>
                <option value="myr">myr</option>
                <option value="ngn">ngn</option>
                <option value="nok">nok</option>
                <option value="nzd">nzd</option>
                <option value="php">php</option>
                <option value="pkr">pkr</option>
                <option value="pln">pln</option>
                <option value="rub">rub</option>
                <option value="sar">sar</option>
                <option value="sek">sek</option>
                <option value="sgd">sgd</option>
                <option value="thb">thb</option>
                <option value="try">try</option>
                <option value="twd">twd</option>
                <option value="uah">uah</option>
                <option value="vef">vef</option>
                <option value="vnd">vnd</option>
                <option value="zar">zar</option>
                <option value="xdr">xdr</option>
                <option value="xag">xag</option>
                <option value="xau">xau</option>
                <option value="bits">bits</option>
                <option value="sats">sats</option>        
            </select>
        </div>

        <table id="coins" class="table table-striped table-hover">
            <thead>
            <tr>
                <th>Id</th>
                <th>Symbol</th>
                <th>Name</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>

        <div class="mt-2">
            <p>URL to use: <a id="url" href="" target="_blank"><code></code></a></p>
        </div>
    </div>
    <script>
        var c_coin = "bitcoin", c_currency = "usd";

        function formatUrl() {
            var host = location.protocol + "//" + location.hostname + (location.port != 80 ? ":" + location.port : "");
            var endpoint = host + "/price/" + c_currency + "?coin=" + c_coin;
            $("#url code").text(endpoint); 
            $("#url")[0].href = endpoint;
        }

        $(document).ready( function () {
            formatUrl();
            $("#currency").on("input", function (e) { 
                c_currency = e.target.value;
                formatUrl();
            });
            var t = $('table').DataTable({ 
                ajax: {
                    url: '/data/coinlist',
                    dataSrc: ""
                },
                columns: [
                    { "data": "id" },
                    { "data": "symbol" },
                    { "data": "name" }
                ],
                select: 'single' 
            });
            t.on('select', function ( e, dt, type, indexes ) {
                if (type === 'row') {
                    var data = dt.rows(indexes).data();
                    console.log(data);
                    c_coin = data[0]["id"];
                    formatUrl();
                }
            } );            
        } );
    </script>
</body>
</html>